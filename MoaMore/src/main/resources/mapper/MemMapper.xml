<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.yedam.moa.mem.mapper.MemMapper">

	<select id="openSesame" resultType="MemVO">
		SELECT 	r.id as id_co,
				r.ttl,
				r.expr_dt,
				r.recruit_no,
				r.co_img,
				c.co_nm,
				m.email
		FROM 	co c join recruit_anun r
		ON 		r.id = c.id
					join member m
					on c.id = m.id
		WHERE 	r.id IN (SELECT id_co
						 FROM following
						 WHERE id_mem = #{id})
	</select>
	<select id="getSearch" resultType="MemVO">
		select  s.aply_dt, 
				s.aply_st, 
				r.ttl, 
				r.expr_dt, 
				s.st
		from 	recruit_anum_st s join recruit_anun r
		on		s.recruit_no = r.recruit_no
		where	s.id = #{id}
		<if test="#{period} == 7">
			and s.aply_dt BETWEEN sysdate-7 and sysdate
		</if>
		<if test="#{period} == 1">
			and s.aply_dt BETWEEN ADD_MONTHS(sysdate,-1) and sysdate 
		</if>
		<if test="#{period} == 2">
			and s.aply_dt BETWEEN ADD_MONTHS(sysdate,-2) and sysdate  
		</if> 
		<if test="#{period} == 3">
			and s.aply_dt BETWEEN ADD_MONTHS(sysdate,-3) and sysdate  
		</if>
<!-- 		<if test='#{expir} == "J2"'> -->
<!-- 			<![CDATA[and sysdate - to_date(r.expr_dt,'yyyy-MM-dd') > 0]]> -->
<!-- 		</if>		 -->
<!-- 		<if test='#{expir} == "J1"'> -->
<!-- 			<![CDATA[and sysdate - to_date(r.expr_dt,'yyyy-MM-dd') <= 0]]> -->
<!-- 		</if> -->
<!-- 		<if test='#{startDt} != null and #{endDt} != null '> -->
<!-- 			and s.aply_dt BETWEEN #{startDt} and #{endDt} -->
<!-- 		</if> -->
<!-- 		<if test='#{st} != null '> -->
<!-- 			and s.st = #{st} -->
<!-- 		</if> -->
<!-- 		<if test='#{aplySt} != null '> -->
<!-- 			and s.aply_st = #{aplySt} -->
<!-- 		</if> -->

<!-- 	select  s.aply_dt, -->
<!-- 			s.aply_st, -->
<!-- 			r.ttl, -->
<!-- 			r.expr_dt, -->
<!-- 			s.st -->
<!-- 	from recruit_anum_st s join recruit_anun r -->
<!-- 	on s.recruit_no = r.recruit_no -->
<!-- 	where s.id = #{id} -->
	</select>


</mapper>