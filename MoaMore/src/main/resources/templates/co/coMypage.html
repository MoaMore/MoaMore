<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{template/layout}">
<head>
<meta charset="UTF-8" />
<title>기업마이페이지</title>
<style>
#insertInfo {
	width: 100%;
}

a {
	font-weight: bold;
	color: black;
	hover
}

a:hover {
	cursor: pointer;
}

.interInfer:hover {
	cursor: pointer;
}

.selected {
	text-decoration: underline;
	font-weight: bold;
}

i {
	color: red;
}
</style>
<link rel="stylesheet"
	href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.0/font/bootstrap-icons.css">
<script src="https://code.jquery.com/jquery-1.12.4.min.js"></script>
</head>
<body>
	<div class="container" layout:fragment="content">

		<div class="row">
			<div class="col-lg-3 text-center">
				<div class="card">
					<div class="card-body">
						<h4 th:text="${id.id}"></h4>
						<a id="insertInfo" type="button" class="btn btn-light"
							href="coInfoPage">기업정보등록</a>
						<hr />
						<a href="">받은 관심<i class="bi bi-suit-heart-fill"></i><small
							th:text="${followers}"></small></a><br /> <a href="coRecruit">나의
							공고목록</a><br /> <a href="/coProducts">나의 아이템</a>
						<hr />
						<a href="">개인정보 수정</a>
					</div>
				</div>
			</div>
			<div class="col-lg-9 text-center">
				<div class="card">
					<div class="card-body">
						<div class="row" id="topMenu">
							<a onclick="changeTable('first',this)" class="col text-center "><span
								class="fw-bold fs-7">0</span> <br /> <span
								class="selected fw-bold fs-1">새로운 지원</span> </a><a
								onclick="changeTable('second',this)"
								class="col text-center border-start"><span
								class="fw-bold fs-7">0</span> <br /> <span class="fw-bold fs-1">처리된
									지원</span> </a> <a onclick="changeTable('third',this)"
								class="col text-center border-start"><span
								class="fw-bold fs-7">0</span> <br /> <span class="fw-bold fs-1">관심
									구직글</span> </a>
						</div>
					</div>
				</div>
				<br />
				<div id="tableMenu" class="card">
					<div id="firstTop" class="card-body">
						<h5>새로운 지원</h5>
						<table class="table hover">
							<thead>
								<tr>
									<th>1</th>
									<th>2</th>
									<th>3</th>
								</tr>
							</thead>
							<tbody>
								<tr>
									<td>1</td>
									<td>2</td>
									<td>3</td>
								</tr>
							</tbody>
						</table>
					</div>

					<!-- 밑은 tableMenu 갈아끼우기  -->
					<div id="secondTop" class="card-body" style="display: none">
						<h5>처리된 지원</h5>
						<table class="table hover">
							<thead>
								<tr>
									<th>1</th>
									<th>2</th>
									<th>3</th>
								</tr>
							</thead>
							<tbody>
								<tr>
									<td>1</td>
									<td>2</td>
									<td>3</td>
								</tr>
							</tbody>
						</table>
					</div>

					<div id="thirdTop" class="card-body" style="display: none">
						<h5>
							<span id="smallInter" class="selected interInfer"
								onclick="changeSlash(this,1)">관심 구직글</span> / <span
								class="interInfer" onclick="changeSlash(this,2)">제안 구직글</span>
						</h5>
						
						<div id="selfList" class="col-md-12">
							

						</div>
						<!-- 제안구직글목록 뿌리기 -->
						<!-- 제안구직글목록 뿌리기 끝 -->
					</div>
					<!-- tableMenu갈아끼우기 끝 -->
				</div>
			</div>
		</div>
		<button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#exampleModalLg">Large modal</button>
		<!-- 모달창 -->
		
		<div class="modal fade" id="exampleModalLg" tabindex="-1" aria-labelledby="exampleModalLgLabel" style="display: none;" aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-4" id="exampleModalLgLabel">Large modal</h1>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        ...
      </div>
    </div>
  </div>
</div>
			
		<script>
			const tableMenu = document.querySelector('#tableMenu');
			//상단메뉴클릭
			function changeTable(no, t) {
				let topMenu = document.querySelector('#topMenu');
				let firstTop = document.querySelector('#firstTop');
				let secondTop = document.querySelector('#secondTop');
				let thirdTop = document.querySelector('#thirdTop');
				let selected = topMenu.querySelector('.selected');
				if (no == 'first') {
					firstTop.style.display = 'block';
					secondTop.style.display = 'none';
					thirdTop.style.display = 'none';
					selected.classList.remove('selected');
					t.querySelectorAll('span')[1].classList.add('selected');

				} else if (no == 'second') {
					secondTop.style.display = 'block';
					firstTop.style.display = 'none';
					thirdTop.style.display = 'none';
					selected.classList.remove('selected');
					t.querySelectorAll('span')[1].classList.add('selected');
				} else if (no == 'third') {
					thirdTop.style.display = 'block';
					secondTop.style.display = 'none';
					firstTop.style.display = 'none';
					selected.classList.remove('selected');
					t.querySelectorAll('span')[1].classList.add('selected');
					document.querySelector('#smallInter').click();

				}
			}
			//관심구직글클릭 / 제안구직글클릭
			function changeSlash(t, no) {
				let selected = tableMenu.querySelector('.selected')
				if (no == 1) {
					selected.classList.remove('selected');
					t.classList.add('selected');
					//ajax로 관심구직글 불러오는 함수
					selectInterNoti();
				} else {
					selected.classList.remove('selected');
					t.classList.add('selected');
					//ajax로 제안구직글 불러오는 함수
					selectOfferNoti();
				}
			}
			//관심구직글호출
			function selectInterNoti() {
				$.ajax({
					url : "/selectInterNoti",
					method : "GET",
					dataType : "json",
					success : function(res) {
						console.log(res);
						makeInterList(res);
					},
					error : function(jqXHR, textStatus, errorThrown) {
						console.error(textStatus, errorThrown);
					}
				});
			}
			
			function makeInterList(res){
				let html = '';
				for(let i=0;i<res.length;i++){
					let notice = `<div
						class="row align-items-center border-bottom p-4 mb-3 hoverRow">
						<div class="col-md-3 text-center">
							<a href="#"> <img class="img-fluid"
								src="assets/img/blog/blog-hero.png" alt="">
							</a>
						</div>
						<div class="col-md-6 text-center text-lg-start">
							<div
								class="d-flex align-items-center justify-content-center justify-content-lg-start gap-3">
								<p class="fw-bold mb-0 text-black">`+res[i].dutyFld+`</p>
								<p class="mb-0">`+res[i].regDt+`</p>
								<span><i id="heartIcon"
									class="bi bi-suit-heart-fill text-danger fa-2x"></i></span>
							</div>
							<p class="fs-2 my-3">`+res[i].intro+`</p>
							<div
								class="d-flex align-items-center justify-content-center justify-content-lg-start gap-2">
								<img class="img-fluid" src="assets/img/blog/profile1.png"
									alt="">
								<p class="mb-0">`+res[i].id+`</p>
							</div>
						</div>
						<div class="col-md-3"
							style="display: flex; align-items: center; flex-direction: column;">
							<button type="button" onclick="deleteInter(\'`+res[i].jobSearchNo+`\')"
								class="btn btn-outline-danger btn-sm listBtn">관심</button>
							<button type="button" onclick="offerModal(\'`+res[i].jobSearchNo+`\')"
								class="btn btn-outline-info btn-sm listBtn" data-bs-toggle="modal" data-bs-target="#exampleModalLg">제안</button>
						</div>
					</div>`;
					html += notice;
					notice = '';
				}
				selfList.innerHTML = html;
			}
			//제안모달
			function offerModal(no){
				console.log(no);
			}
			//관심해제
			function deleteOffer(no){
				
			}

			//제안완료된구직글호출
			function selectOfferNoti() {
				$.ajax({
					url : "/selectOfferNoti",
					method : "GET",
					dataType : "json",
					success : function(res) {
						console.log(res);
					},
					error : function(jqXHR, textStatus, errorThrown) {
						console.error(textStatus, errorThrown);
					}
				});
			}
			function test(t) {
				console.log(t);
			}
			
			

			//ajax예시
			/* $.ajax({
				url : "server.php",
				method : "POST",
				data : {
					name : "John",
					age : 30
				},
				dataType : "json",//받는타입
				contentType : "application/json",//보내는타입
				success : function(res) {
					console.log(res);
				},
				error : function(jqXHR, textStatus, errorThrown) {
					console.error(textStatus, errorThrown);
				},
			}); */
		</script>
	</div>
	<!-- container끝 -->
</body>
</html>
