<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{template/layout}">
<head>
<meta charset="UTF-8">
<title>모아모아/커뮤니티</title>

<!-- jobQnADetail.CSS -->
<link href="community/jobQnADetail.css" rel="style">

</head>
<body>
	<div layout:fragment="content">
		<h1>게시글 상세페이지 - 기능먼저 되는지 보고 나중에 화면 수정할거~~~~~</h1>
		<div class="row">
			<div class="col-md-2"></div>
			<div class="col-md-8">
					<div>커뮤니티/취업Q&A</div>
			</div>
			<div class="col-md-2"></div>
		</div>
		<div>
			<p th:text="|작성자 : ${jobQnaDetail.id}|">작성자</p>
			<p th:text="|작성자 : ${jobQnaDetail.ttl}|">제목</p>
			<p th:utext="|내용 : ${jobQnaDetail.htmlCntn}|">내용</p>
			<p th:text="|댓글수 : ${jobQnaDetail.rplyCnt}|">댓글수</p>
			<p th:text="|조회수 : ${jobQnaDetail.inqCnt}|">조회수</p>
			<p>작성일</p>
		</div>
		<div>
			<!-- 로그인된 사용자가 자기가 작성한 게시물이라면 나타나는 버튼 -->
			<th:block th:if="${jobQnaDetail.id}==${#authentication.principal.username}" >
				<button type="button" class="btn btn-outline-secondary radius mx-1 px-4" th:onclick="|location.href='@{/jobQnaMod(qaNotiwrNo=${jobQnaDetail.qaNotiwrNo})}'|" >수정</button>
				<button type="button" class="btn btn-outline-danger radius mx-1 px-4" id="jobQnaDelete" th:data-no="${jobQnaDetail.qaNotiwrNo}">삭제</button>
			</th:block>
		</div>
<script>

//삭제버튼 클릭시 실행하는 함수
$('#jobQnaDelete').on('click', function(){
	Swal.fire({
	  icon: 'warning',
	  title: '해당 게시글을 \n정말 삭제하시겠습니까?',
	  showCancelButton: true,
	  confirmButtonColor: '#d33',
	  cancelButtonColor: '#3085d6',
	  confirmButtonText: '삭제',
	  cancelButtonText: '취소',
	  buttonsStyling: true,
	  reverseButtons: true
	}).then((result) => {
	  if (result.isConfirmed) {
		  let qaNotiwrNo = $('#jobQnaDelete').data('no');
		  $.ajax({
			url: 'jobQnaDelete',
			type: 'post',
			data: {qaNotiwrNo : qaNotiwrNo},
			success: function (result) {
				
				if(result.result == 'Success'){
					Swal.fire({
					  icon: 'success',
					  title: '삭제완료!',
					  showCancelButton: false,
					  confirmButtonText: '확인'
					}).then((result) => {
					  if (result.isConfirmed) {
						location.href="/jobQnA";
					  }
					});
				}else{
					Swal.fire({
						  icon: 'error',
						  title: '게시글 삭제실패!'
					});
				}
				
			},
	 		error: function (reject) {	   
	    		console.log(reject);
			}
		});
	  } // if끝
	});
});

</script>
	</div>
</body>
</html>